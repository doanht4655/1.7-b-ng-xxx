var bls=function(){"use strict";function gt(t){return t}const Q=!1,_={equals:(t,e)=>t===e};let Z=j;const S=1,T=2;var A=null;let V=null,H=null,f=null,h=null,v=null,x=0;function B(t,e){e=e?Object.assign({},_,e):_;const r={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},s=n=>(typeof n=="function"&&(n=n(r.value)),D(r,n));return[tt.bind(r),s]}function X(t){if(f===null)return t();const e=f;f=null;try{return t()}finally{f=e}}function tt(){if(this.sources&&this.state)if(this.state===S)Y(this);else{const t=h;h=null,k(()=>P(this)),h=t}if(f){const t=this.observers?this.observers.length:0;f.sources?(f.sources.push(this),f.sourceSlots.push(t)):(f.sources=[this],f.sourceSlots=[t]),this.observers?(this.observers.push(f),this.observerSlots.push(f.sources.length-1)):(this.observers=[f],this.observerSlots=[f.sources.length-1])}return this.value}function D(t,e,r){let s=t.value;return(!t.comparator||!t.comparator(s,e))&&(t.value=e,t.observers&&t.observers.length&&k(()=>{for(let n=0;n<t.observers.length;n+=1){const a=t.observers[n],d=V&&V.running;d&&V.disposed.has(a),(d?!a.tState:!a.state)&&(a.pure?h.push(a):v.push(a),a.observers&&z(a)),d||(a.state=S)}if(h.length>1e6)throw h=[],new Error})),e}function Y(t){if(!t.fn)return;C(t);const e=x;et(t,t.value,e)}function et(t,e,r){let s;const n=A,a=f;f=A=t;try{s=t.fn(e)}catch(d){return t.pure&&(t.state=S,t.owned&&t.owned.forEach(C),t.owned=null),t.updatedAt=r+1,K(d)}finally{f=a,A=n}(!t.updatedAt||t.updatedAt<=r)&&(t.updatedAt!=null&&"observers"in t?D(t,s):t.value=s,t.updatedAt=r)}function $(t){if(t.state===0)return;if(t.state===T)return P(t);if(t.suspense&&X(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<x);)t.state&&e.push(t);for(let r=e.length-1;r>=0;r--)if(t=e[r],t.state===S)Y(t);else if(t.state===T){const s=h;h=null,k(()=>P(t,e[0])),h=s}}function k(t,e){if(h)return t();let r=!1;h=[],v?r=!0:v=[],x++;try{const s=t();return rt(r),s}catch(s){r||(v=null),h=null,K(s)}}function rt(t){if(h&&(j(h),h=null),t)return;const e=v;v=null,e.length&&k(()=>Z(e))}function j(t){for(let e=0;e<t.length;e++)$(t[e])}function P(t,e){t.state=0;for(let r=0;r<t.sources.length;r+=1){const s=t.sources[r];if(s.sources){const n=s.state;n===S?s!==e&&(!s.updatedAt||s.updatedAt<x)&&$(s):n===T&&P(s,e)}}}function z(t){for(let e=0;e<t.observers.length;e+=1){const r=t.observers[e];r.state||(r.state=T,r.pure?h.push(r):v.push(r),r.observers&&z(r))}}function C(t){let e;if(t.sources)for(;t.sources.length;){const r=t.sources.pop(),s=t.sourceSlots.pop(),n=r.observers;if(n&&n.length){const a=n.pop(),d=r.observerSlots.pop();s<n.length&&(a.sourceSlots[d]=s,n[s]=a,r.observerSlots[s]=d)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)C(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)C(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function st(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function K(t,e=A){throw st(t)}async function nt(t,e,r){if(!t()||t().enabled===!1||t().options[r].active===!1)return!1;function s(b){return b.replace(/^https?:\/\/(www\.)?/,"")}const n=e(),a=s(n);return!t().blacklist.some(b=>{const M=s(b);return a===M})}const it="1.3.0",ot={matches:["<all_urls>"],allFrames:!0,async main(){let t;try{t=window.top.document.location.href}catch{t=window.location.href}const[e]=B(t),[r,s]=B(await chrome.storage.local.get("settings"));if(s(r().settings),!await nt(r,e,"BLS"))return;let d=!1,b=!1;r().APIKEY;const M=()=>!navigator.onLine||b||r().APIKEY===void 0||r().APIKEY===""||r().PLANTYPE===null;let y=await ft();for(;d===!1&&!y.blacklist.includes(e)&&!M();)if(await L(2e3),d===!1){d=!0;try{const i=document.querySelector("#btnVerify");if(i&&y.options.BLS.autoOpen===!0&&i.click(),await L(500),y.options.BLS.autoSolve===!0&&await ut()){const c=document.createElement("script");c.src=chrome.runtime.getURL("themes/bls.js"),(document.head||document.documentElement).appendChild(c),await dt(),L(1e3)}}catch(i){console.log("Error in BLS",i),d=!1}}async function ut(){return!!document.querySelector(".col-4")}async function ft(){return new Promise((i,c)=>{chrome.storage.local.get(["settings"],p=>{chrome.runtime.lastError?c(chrome.runtime.lastError.message):i(p.settings)})})}function L(i){return new Promise(c=>setTimeout(c,i))}function w(i,c){const p=[...document.querySelectorAll(".col-4")].filter(o=>o.getClientRects().length);let u=0,l=null;for(let o=0;o<p.length;o++){const m=document.defaultView.getComputedStyle(p[o],null),g=m.getPropertyValue("left"),E=m.getPropertyValue("top"),R=m.getPropertyValue("z-index");g==i+"px"&&E==c+"px"&&R>u&&R!="auto"&&(u=R,l=p[o])}return l}function ht(){const i=[...document.querySelectorAll(".box-label")];let c=0,p=null;for(let u=0;u<i.length;u++){const l=document.defaultView.getComputedStyle(i[u],null).getPropertyValue("z-index");l>c&&l!=="auto"&&(c=l,p=i[u].innerText.replace(/\D/g,""))}return p}async function pt(i,c="createTask",p="POST"){return new Promise((u,l)=>{const o={type:"networkRequest",payload:{url:"https://api.nocaptchaai.com/createTask",method:"POST",headers:{"Content-Type":"application/json",apikey:y.APIKEY,softid:`chromeExt_V${it}`},body:JSON.stringify(i)}};chrome.runtime.sendMessage(o,m=>{if(!m)return l(new Error("No response received from chrome.runtime.sendMessage."));if(m.success){const g=m.data,E={"Invalid apikey":"Invalid apikey","Daily limit exhausted.":"Daily limit exhausted!",ERROR_ZERO_BALANCE:"Insufficient Balance!","Wallet limit exhausted.":"Wallet limit exhausted!"};if(((mt,G)=>{const J=E[mt]||E[G]||G;return J?(chrome.runtime.sendMessage({action:J}),b=!0,!0):!1})(g.error,g.error))return;u(g)}else l("Error for Request on bls:",m.error),console.error("Error for Request on bls:",m.error)})})}async function I(i,c={}){const p=["mouseover","mousedown","mouseup","click"];c.bubbles=!0,p.forEach(u=>{const l=new MouseEvent(u,c);i.dispatchEvent(l)})}async function dt(){const i=[w(0,0),w(110,0),w(220,0),w(0,110),w(110,110),w(220,110),w(0,220),w(110,220),w(220,220)],c=ht(),p=[];await L(1e3),Array.from(i).forEach((u,l)=>{const o=u?.querySelector("img");o&&(p.push(o.src.replace(/^data:image\/(png|jpeg|gif);base64,/,"")),o.src)}),y.APIKEY!=""&&Object.keys(p).length!=0&&(async()=>{try{const u=await pt({clientKey:r().APIKEY,task:{type:"ImageToTextTask",images:p,numeric:!0,module:"morocco",case:!1,maxLength:3}});if(u){const l=u.solution.text;if(Array.isArray(l)){l.forEach((m,g)=>{const E=i[g].querySelector("img");m===c&&I(E)});const o=document.querySelector("#captchaForm > div.text-center.row.no-gutters.img-actions.p-2 > div:nth-child(3)");o&&I(o)}else if(l&&typeof l=="object"){Object.keys(l).forEach(m=>{const g=i[m].querySelector("img");g&&l[m]===c&&I(g)});const o=document.querySelector("#captchaForm > div.text-center.row.no-gutters.img-actions.p-2 > div:nth-child(3)");o&&I(o)}else{const o=document.querySelector("#captchaForm > div.text-center.row.no-gutters.img-actions.p-2 > div:nth-child(2)");o&&I(o)}}}catch(u){console.log("error fetching bls data",u)}})()}}},W=globalThis.browser?.runtime?.id?globalThis.browser:globalThis.chrome;function N(t,...e){}const at={debug:(...t)=>N(console.debug,...t),log:(...t)=>N(console.log,...t),warn:(...t)=>N(console.warn,...t),error:(...t)=>N(console.error,...t)};class O extends Event{constructor(e,r){super(O.EVENT_NAME,{}),this.newUrl=e,this.oldUrl=r}static EVENT_NAME=U("wxt:locationchange")}function U(t){return`${W?.runtime?.id}:bls:${t}`}function lt(t){let e,r;return{run(){e==null&&(r=new URL(location.href),e=t.setInterval(()=>{let s=new URL(location.href);s.href!==r.href&&(window.dispatchEvent(new O(s,r)),r=s)},1e3))}}}class q{constructor(e,r){this.contentScriptName=e,this.options=r,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}static SCRIPT_STARTED_MESSAGE_TYPE=U("wxt:content-script-started");isTopFrame=window.self===window.top;abortController;locationWatcher=lt(this);receivedMessageIds=new Set;get signal(){return this.abortController.signal}abort(e){return this.abortController.abort(e)}get isInvalid(){return W.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(e){return this.signal.addEventListener("abort",e),()=>this.signal.removeEventListener("abort",e)}block(){return new Promise(()=>{})}setInterval(e,r){const s=setInterval(()=>{this.isValid&&e()},r);return this.onInvalidated(()=>clearInterval(s)),s}setTimeout(e,r){const s=setTimeout(()=>{this.isValid&&e()},r);return this.onInvalidated(()=>clearTimeout(s)),s}requestAnimationFrame(e){const r=requestAnimationFrame((...s)=>{this.isValid&&e(...s)});return this.onInvalidated(()=>cancelAnimationFrame(r)),r}requestIdleCallback(e,r){const s=requestIdleCallback((...n)=>{this.signal.aborted||e(...n)},r);return this.onInvalidated(()=>cancelIdleCallback(s)),s}addEventListener(e,r,s,n){r==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),e.addEventListener?.(r.startsWith("wxt:")?U(r):r,s,{...n,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),at.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:q.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(e){const r=e.data?.type===q.SCRIPT_STARTED_MESSAGE_TYPE,s=e.data?.contentScriptName===this.contentScriptName,n=!this.receivedMessageIds.has(e.data?.messageId);return r&&s&&n}listenForNewerScripts(e){let r=!0;const s=n=>{if(this.verifyScriptStartedEvent(n)){this.receivedMessageIds.add(n.data.messageId);const a=r;if(r=!1,a&&e?.ignoreFirstEvent)return;this.notifyInvalidated()}};addEventListener("message",s),this.onInvalidated(()=>removeEventListener("message",s))}}function bt(){}function F(t,...e){}const ct={debug:(...t)=>F(console.debug,...t),log:(...t)=>F(console.log,...t),warn:(...t)=>F(console.warn,...t),error:(...t)=>F(console.error,...t)};return(async()=>{try{const{main:t,...e}=ot,r=new q("bls",e);return await t(r)}catch(t){throw ct.error('The content script "bls" crashed on startup!',t),t}})()}();
bls;
