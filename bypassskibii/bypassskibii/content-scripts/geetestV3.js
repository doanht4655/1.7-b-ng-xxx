var geetestv3=function(){"use strict";function We(e){return e}const ue=!1,H={equals:(e,t)=>e===t};let de=Q;const R=1,P=2;var B=null;let X=null,fe=null,g=null,m=null,A=null,$=0;function K(e,t){t=t?Object.assign({},H,t):H;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},s=r=>(typeof r=="function"&&(r=r(n.value)),J(n,r));return[he.bind(n),s]}function ge(e){if(g===null)return e();const t=g;g=null;try{return e()}finally{g=t}}function he(){if(this.sources&&this.state)if(this.state===R)Z(this);else{const e=m;m=null,L(()=>Y(this)),m=e}if(g){const e=this.observers?this.observers.length:0;g.sources?(g.sources.push(this),g.sourceSlots.push(e)):(g.sources=[this],g.sourceSlots=[e]),this.observers?(this.observers.push(g),this.observerSlots.push(g.sources.length-1)):(this.observers=[g],this.observerSlots=[g.sources.length-1])}return this.value}function J(e,t,n){let s=e.value;return(!e.comparator||!e.comparator(s,t))&&(e.value=t,e.observers&&e.observers.length&&L(()=>{for(let r=0;r<e.observers.length;r+=1){const i=e.observers[r],a=X&&X.running;a&&X.disposed.has(i),(a?!i.tState:!i.state)&&(i.pure?m.push(i):A.push(i),i.observers&&ee(i)),a||(i.state=R)}if(m.length>1e6)throw m=[],new Error})),t}function Z(e){if(!e.fn)return;D(e);const t=$;me(e,e.value,t)}function me(e,t,n){let s;const r=B,i=g;g=B=e;try{s=e.fn(t)}catch(a){return e.pure&&(e.state=R,e.owned&&e.owned.forEach(D),e.owned=null),e.updatedAt=n+1,te(a)}finally{g=i,B=r}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?J(e,s):e.value=s,e.updatedAt=n)}function z(e){if(e.state===0)return;if(e.state===P)return Y(e);if(e.suspense&&ge(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<$);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===R)Z(e);else if(e.state===P){const s=m;m=null,L(()=>Y(e,t[0])),m=s}}function L(e,t){if(m)return e();let n=!1;m=[],A?n=!0:A=[],$++;try{const s=e();return pe(n),s}catch(s){n||(A=null),m=null,te(s)}}function pe(e){if(m&&(Q(m),m=null),e)return;const t=A;A=null,t.length&&L(()=>de(t))}function Q(e){for(let t=0;t<e.length;t++)z(e[t])}function Y(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const s=e.sources[n];if(s.sources){const r=s.state;r===R?s!==t&&(!s.updatedAt||s.updatedAt<$)&&z(s):r===P&&Y(s,t)}}}function ee(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=P,n.pure?m.push(n):A.push(n),n.observers&&ee(n))}}function D(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),s=e.sourceSlots.pop(),r=n.observers;if(r&&r.length){const i=r.pop(),a=n.observerSlots.pop();s<r.length&&(i.sourceSlots[a]=s,r[s]=i,n.observerSlots[s]=a)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)D(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)D(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function we(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function te(e,t=B){throw we(e)}const ve="1.3.0",be=(e,t)=>{const n=document.createElement("div");n.style.cssText="position:fixed;top:8%;left:0;background-color:rgba(0,0,0,.6);padding:2px;color:#fff;font:calc(14px + .5vw) 'Arial',sans-serif;font-weight:bold;text-transform:uppercase;letter-spacing:1px;z-index:9999;transition:all 1s;animation:slideIn 1s forwards",n.innerHTML=`<p>${e}. Retrying in..<span id="countdown">${t}</span></p>`,document.body.appendChild(n),(()=>{const i=document.getElementById("countdown");if(!i)return;let a=t;const y=setInterval(()=>{a--,i.textContent=a,a<=0&&clearInterval(y)},1e3)})();const r=document.createElement("style");r.innerHTML="@keyframes slideIn{0%{transform:translateX(-100%)}100%{transform:translateX(0)}}@keyframes slideOut{0%{transform:translateX(0)}100%{transform:translateX(100%)}}",document.head.appendChild(r),setTimeout(()=>{n.style.animation="slideOut 1s forwards",setTimeout(()=>{document.body.removeChild(n)},1e3)},t*1e3)},_=e=>document.querySelector(e),ne=e=>document.querySelectorAll(e);function se(){return _(".task-answers")!==null}function re(){return ne(".task-image .image").length===9}function oe(){return _(".bounding-box-example")!==null}function ye(){return _(".challenge-header")!==null&&_(".bounding-box-example")===null&&_(".task-grid")==null}function Ee(){const e=document.body.getBoundingClientRect();return e?.width===0||e?.height===0?!1:document.querySelector("div.check")!==null}function M(e){return new Promise(t=>setTimeout(t,e))}function Se(e,t){return Math.floor(Math.random()*(t-e)+e)}function ke(){try{const e=document.querySelector("div.check");return e&&e.style.display==="block"}catch(e){return console.error(e),!1}}async function Ie(e){const t=await(await fetch(e,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,/;q=0.8,application/signed-exchange;v=b3;q=0.7","accept-language":"en-US,en;q=0.9","cache-control":"max-age=0","if-modified-since":"Mon, 11 Dec 2023 02:26:04 GMT","if-none-match":'"CFDAD5AA0CE4A3068FF1CABAC59E4D9D"',priority:"u=0, i","sec-ch-ua":'"Chromium";v="130", "Google Chrome";v="130", "Not?A_Brand";v="99"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"none","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors"})).blob();return await Ce(t)}async function Ce(e){return new Promise(t=>{const n=new FileReader;n.readAsDataURL(e),n.addEventListener("loadend",()=>{const s=n.result.replace(/^data:image\/(png|jpeg);base64,/,"");t(s)}),n.addEventListener("error",()=>{logs&&console.log("❌ Failed to convert url to base64")})})}async function ie(e){const t=await(await fetch(e)).blob();return new Promise(n=>{const s=new FileReader;s.readAsDataURL(t),s.addEventListener("loadend",()=>{n(s.result.replace(/^data:image\/(png|jpeg|webp);base64,/,""))}),s.addEventListener("error",()=>{logs&&console.log("❌ Failed to convert url to base64")})})}function xe(){document.querySelectorAll("iframe").forEach(t=>{t.src=t.src})}async function Ae(){oe()?(await M(200),document.querySelector(".display-language.button").click(),await M(100),document.querySelector(".language-selector .option:nth-child(23)").click()):re()?(await M(100),document.querySelector(".language-selector .option:nth-child(23)").click()):se()&&(document.querySelector(".display-language.button").click(),await M(200),document.querySelector(".language-selector .option:nth-child(23)").click(),await M(200))}function Te(){document.querySelector(".button-submit").click()}async function qe(){const e=navigator.userAgent;let t,n=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(e)||[],`IE ${t[1]||""}`):n[1]==="Chrome"&&(t=e.match(/\b(OPR|Edge)\/(\d+)/),t!=null)?t.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],(t=e.match(/version\/(\d+)/i))!=null&&n.splice(1,1,t[1]),{version:n,platform:navigator.platform})}function _e(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}function G(e){["mouseover","mousedown","mouseup","click"].forEach(t=>{if(e.fireEvent)e.fireEvent("on"+t);else{const n=document.createEvent("MouseEvents");n.initEvent(t,!0,!1),e.dispatchEvent(n)}})}function V(e,t,n,s,r,i,a){e.dispatchEvent(new MouseEvent(t,{bubbles:!0,clientX:n,clientY:s,buttons:r,button:i,pressure:a}))}async function Me(e,t){const n=document.querySelector("canvas");if(e!==void 0)for(const{from:s,to:r}of e)if(console.log("Coordinates from:",s,"to:",r),Array.isArray(s)&&s.length!==0&&Array.isArray(r)&&r.length!==0){const[i,a]=s,[y,E]=r,h=n.getBoundingClientRect(),S=i+h.left,w=a+h.top,C=y+h.left,p=E+h.top;V(n,"mousedown",S,w,1,0,1),await new Promise(c=>setTimeout(c,t));const I=C-S,k=p-w,T=Math.sqrt(I**2+k**2),o=Math.round(T/6),l=I/o,u=k/o;for(let c=1;c<=o;c++){const b=S+l*c,d=w+u*c;V(n,"mousemove",b,d,1,0,1),await new Promise(v=>setTimeout(v,50))}V(n,"mouseup",C,p,0,0,0)}else f.$(".button-submit").click();else f.$(".button-submit").click()}async function Re(e){function t(i,a,y){console.log("clickedOn Canvas");const E=i.getBoundingClientRect(),h=["mouseover","mousedown","mouseup","click"],S={clientX:a+E.left,clientY:y+E.top,bubbles:!0};for(let w=0;w<h.length;w++){const C=new MouseEvent(h[w],S);i.dispatchEvent(C)}}const n=document.querySelector("canvas");n.addEventListener("mousedown",i=>{const a=n.getBoundingClientRect();event.clientX-a.left,event.clientY-a.top});const[s,r]=e;t(n,s,r),await f.sleep(2e3)}async function Pe(e,t){const n=(await chrome.storage.local.get("customEndpoint")).customEndpoint;return t==="custom"?`https://${n}/${e}`:`https://${t}.nocaptchaai.com/${e}`}async function Be(e){for(const t of e){const n=[...document.querySelectorAll(".answer-text")].find(s=>s.outerText===t);G(n),[...document.querySelectorAll(".answer-example")].some(s=>s.style.backgroundColor==="rgb(116, 116, 116)")||G(n)}}async function $e(){const e=document.querySelector("canvas");if(!e)return null;const[t,n]=[e.width,e.height],r=e.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,t,n);if((p=>{const I=p.data;for(let k=0;k<I.length;k+=4){const T=I[k],o=I[k+1],l=I[k+2];if(T!==o||o!==l)return!1}return!0})(r))return null;const a=parseInt(e.style.width,10),y=parseInt(e.style.height,10);if(a<=0||y<=0)return null;const E=Math.min(a/t,y/n),[h,S]=[t*E,n*E],w=document.createElement("canvas");return Object.assign(w,{width:h,height:S}),w.getContext("2d").drawImage(e,0,0,t,n,0,0,h,S),w.toDataURL("image/jpeg").replace(/^data:image\/(png|jpeg);base64,/,"")}function Le(e){return[...document.querySelectorAll(`${e}`)].map(t=>t.style.backgroundImage.replace(/url\("|"\)/g,""))}function Ye(e){return Promise.all(e.map(async(t,n)=>(e[n]=await ie(t),e[n])))}async function De(e,t,n){const s=e.getBoundingClientRect(),r=s.left+window.scrollX,i=s.top+window.scrollY,a=r+t,y=i+n,E=new MouseEvent("mousedown",{clientX:r,clientY:i,bubbles:!0});e.dispatchEvent(E),await new Promise(p=>setTimeout(p,1e3));const h=5,S=(a-r)/h,w=(y-i)/h;for(let p=1;p<=h;p++){const I=r+S*p,k=i+w*p,T=new MouseEvent("mousemove",{clientX:I,clientY:k,bubbles:!0});e.dispatchEvent(T),await new Promise(o=>setTimeout(o,150))}await f.sleep(1e3);const C=new MouseEvent("mouseup",{clientX:a,clientY:y,bubbles:!0});e.dispatchEvent(C),await new Promise(p=>setTimeout(p,2e3))}async function Fe(e,t,n){try{const r=await(await fetch(e,{method:"POST",headers:n,body:JSON.stringify(t)})).json();if(r.error&&r.error.includes("Daily limit exhausted.")){chrome.runtime.sendMessage({action:"Daily limit exhausted!"}),stop=!0;return}if(r.errorCode==="ERROR_ZERO_BALANCE"){chrome.runtime.sendMessage({action:"Insufficient Balance!"}),stop=!0;return}if(r.error&&r.error.includes("Wallet limit exhausted.")){chrome.runtime.sendMessage({action:"Wallet limit exhausted."}),stop=!0;return}return r}catch(s){throw console.error("Error fetching coordinates:",s),s}}async function Ue(e){return new Promise(t=>{chrome.runtime.sendMessage({type:"GET_IMAGE_BASE64",payload:{url:e}},n=>{n?.success?t(n.data):t(null)})})}const f={version:ve,$:_,$$:ne,isMulti:se,isGrid:re,isBbox:oe,isBboxDD:ye,isWidget:Ee,sleep:M,randTimer:Se,isSolved:ke,countdownNotif:be,getBase64FromUrl:ie,refreshIframes:xe,getEn:Ae,skip:Te,getBrowser:qe,shuffle:_e,fireMouseEvents:G,getCanvas:Re,handleCanvasDD:Me,getApi:Pe,clickMatchingElement:Be,sliceOG:$e,updateExamples:Ye,getExamples:Le,solveGeetestCaptcha:De,sendCoordinatesRequest:Fe,geeFetchImage:Ie,fetchBase64Image:Ue},Oe={matches:["<all_urls>"],allFrames:!0,match_about_blank:!1,async main(){let e;try{e=window.top.document.location.href}catch{e=window.location.href}const[t]=K(e),[n,s]=K(await chrome.storage.local.get("settings"));s(n().settings),(async()=>{let r=!1,i=null,a=null;const y=()=>!navigator.onLine||n().APIKEY===void 0||n().APIKEY===""||n().PLANTYPE===null||n()?.enabled===!1;if(window.geetestV3Injected)return;window.geetestV3Injected=!0;let E=null;for(;!y()&&r===!0;){await f.sleep(3e3);let o=f.$("div.geetest_radar_tip"),l=o?.getAttribute("aria-label");o!=null&&l=="Click to verify"&&n().options.GeeTest.autoOpen===!0&&n()?.enabled===!0&&!await h()&&S(o),(i===null||i===""||i===void 0)&&document.querySelectorAll("script").forEach(v=>{v.src.includes("get.php")&&(i=new URL(v.src).searchParams.get("gt"))});let u=document.querySelector("div.geetest_click"),c=document.querySelector(".geetest_slider");u&&(a="geetest_click"),c&&(a="geetest_slide");let b=f.$("div.geetest_item_wrap");if(o!=null&&b&&await h())a&&await C(a),await k([[{x:146,y:90},{x:72,y:127},{x:224,y:122}]],300),await T();else if(c){let d=null;if(a&&(d=await C(a),!d))continue;if(d&&d.task.images.length>0){const v="https://api.nocaptchaai.com/createTask",x={"Content-Type":"application/json",apikey:n().APIKEY},q=await I(v,d,x);if(q)if(q.solution.slide.length>0){const N=document.querySelector("div.geetest_slider_button");await f.solveGeetestCaptcha(N,q.solution.slide[0],q.solution.slide[1])}else document.querySelector(".geetest_refresh")?.click()}}}async function h(){return!!f.$("div.geetest_radar_click_ready")}function S(o){if(!o)return;const l=o.getBoundingClientRect(),u=l.left+l.width/2+(Math.random()-.5)*5,c=l.top+l.height/2+(Math.random()-.5)*5;o.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,view:window,clientX:u,clientY:c})),setTimeout(()=>{o.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,view:window,clientX:u,clientY:c})),o.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window,clientX:u,clientY:c}))},Math.random()*200+50)}async function w(o){if(!o)return console.error("Element not found:",o),[];const l=o.style.backgroundImage,u=[];if(l){const c=l.match(/url\("(.*?)"\)/);c?u.push(c[1]):console.log("No URL found in background-image for:",o)}return u}async function C(o){if(!["geetest_click","geetest_slide"].includes(o))throw new Error(`Unsupported captcha type: ${o}`);const l={clientKey:n().APIKEY,source:"chrome",version:f.version,appID:0,task:{type:"GeetestClassification",gtv:3,images:[],slice:"",question:"",websiteURL:t()}};if(o==="geetest_click"){const u=f.$("div.geetest_item_wrap"),c=await w(u);if(c.length>0){const v=await f.geeFetchImage(c[0]);l.task.images.push(v)}else console.warn("No background image URL found.");const b=document.querySelector("div.geetest_tip_content"),d=b?b.innerText.trim():"";l.task.question=`${o}:${d}`}if(o==="geetest_slide"){const u=document.querySelectorAll("canvas");if(document.querySelector("div.geetest_slider_tip")?.textContent,u.length>=2){const c=p(u[0].toDataURL()),b=p(u[1].toDataURL()),d=c+b;if(E&&E===d)return document.querySelector(".geetest_refresh")?.click(),await f.sleep(2e3),null;E=d,l.task.images.push(c),l.task.slice=b,l.task.question="slide"}}return l}function p(o){return o.replace(/^data:image\/\w+;base64,/,"")}async function I(o,l,u){return new Promise((c,b)=>{try{const d={type:"networkRequest",payload:{url:o,method:"POST",headers:u,body:JSON.stringify(l)}};chrome.runtime.sendMessage(d,async v=>{if(!v.success){console.error("Error for Request 2:",v.error);return}const x=v.data;((N,Ve)=>{const ce={"Invalid apikey":"Invalid apikey","Daily limit exhausted.":"Daily limit exhausted!",ERROR_ZERO_BALANCE:"Insufficient Balance!","Wallet limit exhausted.":"Wallet limit exhausted."},le=ce[N]||ce[Ve];return le?(chrome.runtime.sendMessage({action:le}),r=!0,!0):!1})(x.error,x.message)||c(x)})}catch(d){return console.error("Error fetching coordinates:",d),b(d)}})}async function k(o,l){const u=f.$("div.geetest_item_wrap").querySelector("img");if(!u)return;const c=u.getBoundingClientRect();for(const b of o)if(b.length>0)for(const d of b){const v=c.left+d.x,x=c.top+d.y;console.log(v,x,"click points"),await f.sleep(1e3);const q=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0,clientX:v,clientY:x});u.dispatchEvent(q),await f.sleep(l)}else{let d=document.querySelectorAll(".geetest_refresh");d[d.length-1].click()}}async function T(){const o=f.$("div.geetest_commit_tip");if(o&&o.click(),f.$("div.geetest_commit.geetest_disable")){let u=document.querySelectorAll(".geetest_refresh");u[u.length-1].click()}}})()}},ae=globalThis.browser?.runtime?.id?globalThis.browser:globalThis.chrome;function F(e,...t){}const Ne={debug:(...e)=>F(console.debug,...e),log:(...e)=>F(console.log,...e),warn:(...e)=>F(console.warn,...e),error:(...e)=>F(console.error,...e)};class W extends Event{constructor(t,n){super(W.EVENT_NAME,{}),this.newUrl=t,this.oldUrl=n}static EVENT_NAME=j("wxt:locationchange")}function j(e){return`${ae?.runtime?.id}:geetestV3:${e}`}function Xe(e){let t,n;return{run(){t==null&&(n=new URL(location.href),t=e.setInterval(()=>{let s=new URL(location.href);s.href!==n.href&&(window.dispatchEvent(new W(s,n)),n=s)},1e3))}}}class U{constructor(t,n){this.contentScriptName=t,this.options=n,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}static SCRIPT_STARTED_MESSAGE_TYPE=j("wxt:content-script-started");isTopFrame=window.self===window.top;abortController;locationWatcher=Xe(this);receivedMessageIds=new Set;get signal(){return this.abortController.signal}abort(t){return this.abortController.abort(t)}get isInvalid(){return ae.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(t){return this.signal.addEventListener("abort",t),()=>this.signal.removeEventListener("abort",t)}block(){return new Promise(()=>{})}setInterval(t,n){const s=setInterval(()=>{this.isValid&&t()},n);return this.onInvalidated(()=>clearInterval(s)),s}setTimeout(t,n){const s=setTimeout(()=>{this.isValid&&t()},n);return this.onInvalidated(()=>clearTimeout(s)),s}requestAnimationFrame(t){const n=requestAnimationFrame((...s)=>{this.isValid&&t(...s)});return this.onInvalidated(()=>cancelAnimationFrame(n)),n}requestIdleCallback(t,n){const s=requestIdleCallback((...r)=>{this.signal.aborted||t(...r)},n);return this.onInvalidated(()=>cancelIdleCallback(s)),s}addEventListener(t,n,s,r){n==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),t.addEventListener?.(n.startsWith("wxt:")?j(n):n,s,{...r,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),Ne.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:U.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(t){const n=t.data?.type===U.SCRIPT_STARTED_MESSAGE_TYPE,s=t.data?.contentScriptName===this.contentScriptName,r=!this.receivedMessageIds.has(t.data?.messageId);return n&&s&&r}listenForNewerScripts(t){let n=!0;const s=r=>{if(this.verifyScriptStartedEvent(r)){this.receivedMessageIds.add(r.data.messageId);const i=n;if(n=!1,i&&t?.ignoreFirstEvent)return;this.notifyInvalidated()}};addEventListener("message",s),this.onInvalidated(()=>removeEventListener("message",s))}}function Ke(){}function O(e,...t){}const Ge={debug:(...e)=>O(console.debug,...e),log:(...e)=>O(console.log,...e),warn:(...e)=>O(console.warn,...e),error:(...e)=>O(console.error,...e)};return(async()=>{try{const{main:e,...t}=Oe,n=new U("geetestV3",t);return await e(n)}catch(e){throw Ge.error('The content script "geetestV3" crashed on startup!',e),e}})()}();
geetestv3;
