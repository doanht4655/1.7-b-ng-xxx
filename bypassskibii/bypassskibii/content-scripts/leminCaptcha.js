var lemincaptcha=function(){"use strict";function _t(t){return t}const et=!1,U={equals:(t,e)=>t===e};let nt=j;const I=1,k=2;var x=null;let $=null,st=null,c=null,l=null,b=null,T=0;function X(t,e){e=e?Object.assign({},U,e):U;const n={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},s=r=>(typeof r=="function"&&(r=r(n.value)),_(n,r));return[ot.bind(n),s]}function rt(t){if(c===null)return t();const e=c;c=null;try{return t()}finally{c=e}}function ot(){if(this.sources&&this.state)if(this.state===I)G(this);else{const t=l;l=null,M(()=>q(this)),l=t}if(c){const t=this.observers?this.observers.length:0;c.sources?(c.sources.push(this),c.sourceSlots.push(t)):(c.sources=[this],c.sourceSlots=[t]),this.observers?(this.observers.push(c),this.observerSlots.push(c.sources.length-1)):(this.observers=[c],this.observerSlots=[c.sources.length-1])}return this.value}function _(t,e,n){let s=t.value;return(!t.comparator||!t.comparator(s,e))&&(t.value=e,t.observers&&t.observers.length&&M(()=>{for(let r=0;r<t.observers.length;r+=1){const o=t.observers[r],i=$&&$.running;i&&$.disposed.has(o),(i?!o.tState:!o.state)&&(o.pure?l.push(o):b.push(o),o.observers&&V(o)),i||(o.state=I)}if(l.length>1e6)throw l=[],new Error})),e}function G(t){if(!t.fn)return;R(t);const e=T;it(t,t.value,e)}function it(t,e,n){let s;const r=x,o=c;c=x=t;try{s=t.fn(e)}catch(i){return t.pure&&(t.state=I,t.owned&&t.owned.forEach(R),t.owned=null),t.updatedAt=n+1,H(i)}finally{c=o,x=r}(!t.updatedAt||t.updatedAt<=n)&&(t.updatedAt!=null&&"observers"in t?_(t,s):t.value=s,t.updatedAt=n)}function W(t){if(t.state===0)return;if(t.state===k)return q(t);if(t.suspense&&rt(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<T);)t.state&&e.push(t);for(let n=e.length-1;n>=0;n--)if(t=e[n],t.state===I)G(t);else if(t.state===k){const s=l;l=null,M(()=>q(t,e[0])),l=s}}function M(t,e){if(l)return t();let n=!1;l=[],b?n=!0:b=[],T++;try{const s=t();return at(n),s}catch(s){n||(b=null),l=null,H(s)}}function at(t){if(l&&(j(l),l=null),t)return;const e=b;b=null,e.length&&M(()=>nt(e))}function j(t){for(let e=0;e<t.length;e++)W(t[e])}function q(t,e){t.state=0;for(let n=0;n<t.sources.length;n+=1){const s=t.sources[n];if(s.sources){const r=s.state;r===I?s!==e&&(!s.updatedAt||s.updatedAt<T)&&W(s):r===k&&q(s,e)}}}function V(t){for(let e=0;e<t.observers.length;e+=1){const n=t.observers[e];n.state||(n.state=k,n.pure?l.push(n):b.push(n),n.observers&&V(n))}}function R(t){let e;if(t.sources)for(;t.sources.length;){const n=t.sources.pop(),s=t.sourceSlots.pop(),r=n.observers;if(r&&r.length){const o=r.pop(),i=n.observerSlots.pop();s<r.length&&(o.sourceSlots[i]=s,r[s]=o,n.observerSlots[s]=i)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)R(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)R(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function ct(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function H(t,e=x){throw ct(t)}const lt="1.3.0",ut=(t,e)=>{const n=document.createElement("div");n.style.cssText="position:fixed;top:8%;left:0;background-color:rgba(0,0,0,.6);padding:2px;color:#fff;font:calc(14px + .5vw) 'Arial',sans-serif;font-weight:bold;text-transform:uppercase;letter-spacing:1px;z-index:9999;transition:all 1s;animation:slideIn 1s forwards",n.innerHTML=`<p>${t}. Retrying in..<span id="countdown">${e}</span></p>`,document.body.appendChild(n),(()=>{const o=document.getElementById("countdown");if(!o)return;let i=e;const a=setInterval(()=>{i--,o.textContent=i,i<=0&&clearInterval(a)},1e3)})();const r=document.createElement("style");r.innerHTML="@keyframes slideIn{0%{transform:translateX(-100%)}100%{transform:translateX(0)}}@keyframes slideOut{0%{transform:translateX(0)}100%{transform:translateX(100%)}}",document.head.appendChild(r),setTimeout(()=>{n.style.animation="slideOut 1s forwards",setTimeout(()=>{document.body.removeChild(n)},1e3)},e*1e3)},y=t=>document.querySelector(t),z=t=>document.querySelectorAll(t);function K(){return y(".task-answers")!==null}function J(){return z(".task-image .image").length===9}function Q(){return y(".bounding-box-example")!==null}function dt(){return y(".challenge-header")!==null&&y(".bounding-box-example")===null&&y(".task-grid")==null}function ft(){const t=document.body.getBoundingClientRect();return t?.width===0||t?.height===0?!1:document.querySelector("div.check")!==null}function S(t){return new Promise(e=>setTimeout(e,t))}function ht(t,e){return Math.floor(Math.random()*(e-t)+t)}function gt(){try{const t=document.querySelector("div.check");return t&&t.style.display==="block"}catch(t){return console.error(t),!1}}async function mt(t){const e=await(await fetch(t,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,/;q=0.8,application/signed-exchange;v=b3;q=0.7","accept-language":"en-US,en;q=0.9","cache-control":"max-age=0","if-modified-since":"Mon, 11 Dec 2023 02:26:04 GMT","if-none-match":'"CFDAD5AA0CE4A3068FF1CABAC59E4D9D"',priority:"u=0, i","sec-ch-ua":'"Chromium";v="130", "Google Chrome";v="130", "Not?A_Brand";v="99"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"none","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors"})).blob();return await pt(e)}async function pt(t){return new Promise(e=>{const n=new FileReader;n.readAsDataURL(t),n.addEventListener("loadend",()=>{const s=n.result.replace(/^data:image\/(png|jpeg);base64,/,"");e(s)}),n.addEventListener("error",()=>{logs&&console.log("❌ Failed to convert url to base64")})})}async function Z(t){const e=await(await fetch(t)).blob();return new Promise(n=>{const s=new FileReader;s.readAsDataURL(e),s.addEventListener("loadend",()=>{n(s.result.replace(/^data:image\/(png|jpeg|webp);base64,/,""))}),s.addEventListener("error",()=>{logs&&console.log("❌ Failed to convert url to base64")})})}function wt(){document.querySelectorAll("iframe").forEach(e=>{e.src=e.src})}async function vt(){Q()?(await S(200),document.querySelector(".display-language.button").click(),await S(100),document.querySelector(".language-selector .option:nth-child(23)").click()):J()?(await S(100),document.querySelector(".language-selector .option:nth-child(23)").click()):K()&&(document.querySelector(".display-language.button").click(),await S(200),document.querySelector(".language-selector .option:nth-child(23)").click(),await S(200))}function bt(){document.querySelector(".button-submit").click()}async function Et(){const t=navigator.userAgent;let e,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(e=/\brv[ :]+(\d+)/g.exec(t)||[],`IE ${e[1]||""}`):n[1]==="Chrome"&&(e=t.match(/\b(OPR|Edge)\/(\d+)/),e!=null)?e.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],(e=t.match(/version\/(\d+)/i))!=null&&n.splice(1,1,e[1]),{version:n,platform:navigator.platform})}function yt(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t}function D(t){["mouseover","mousedown","mouseup","click"].forEach(e=>{if(t.fireEvent)t.fireEvent("on"+e);else{const n=document.createEvent("MouseEvents");n.initEvent(e,!0,!1),t.dispatchEvent(n)}})}function Y(t,e,n,s,r,o,i){t.dispatchEvent(new MouseEvent(e,{bubbles:!0,clientX:n,clientY:s,buttons:r,button:o,pressure:i}))}async function St(t,e){const n=document.querySelector("canvas");if(t!==void 0)for(const{from:s,to:r}of t)if(console.log("Coordinates from:",s,"to:",r),Array.isArray(s)&&s.length!==0&&Array.isArray(r)&&r.length!==0){const[o,i]=s,[a,f]=r,u=n.getBoundingClientRect(),d=o+u.left,h=i+u.top,E=a+u.left,g=f+u.top;Y(n,"mousedown",d,h,1,0,1),await new Promise(C=>setTimeout(C,e));const p=E-d,m=g-h,A=Math.sqrt(p**2+m**2),v=Math.round(A/6),N=p/v,Ot=m/v;for(let C=1;C<=v;C++){const Nt=d+N*C,Ut=h+Ot*C;Y(n,"mousemove",Nt,Ut,1,0,1),await new Promise(Xt=>setTimeout(Xt,50))}Y(n,"mouseup",E,g,0,0,0)}else w.$(".button-submit").click();else w.$(".button-submit").click()}async function Ct(t){function e(o,i,a){console.log("clickedOn Canvas");const f=o.getBoundingClientRect(),u=["mouseover","mousedown","mouseup","click"],d={clientX:i+f.left,clientY:a+f.top,bubbles:!0};for(let h=0;h<u.length;h++){const E=new MouseEvent(u[h],d);o.dispatchEvent(E)}}const n=document.querySelector("canvas");n.addEventListener("mousedown",o=>{const i=n.getBoundingClientRect();event.clientX-i.left,event.clientY-i.top});const[s,r]=t;e(n,s,r),await w.sleep(2e3)}async function It(t,e){const n=(await chrome.storage.local.get("customEndpoint")).customEndpoint;return e==="custom"?`https://${n}/${t}`:`https://${e}.nocaptchaai.com/${t}`}async function At(t){for(const e of t){const n=[...document.querySelectorAll(".answer-text")].find(s=>s.outerText===e);D(n),[...document.querySelectorAll(".answer-example")].some(s=>s.style.backgroundColor==="rgb(116, 116, 116)")||D(n)}}async function kt(){const t=document.querySelector("canvas");if(!t)return null;const[e,n]=[t.width,t.height],r=t.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,e,n);if((g=>{const p=g.data;for(let m=0;m<p.length;m+=4){const A=p[m],v=p[m+1],N=p[m+2];if(A!==v||v!==N)return!1}return!0})(r))return null;const i=parseInt(t.style.width,10),a=parseInt(t.style.height,10);if(i<=0||a<=0)return null;const f=Math.min(i/e,a/n),[u,d]=[e*f,n*f],h=document.createElement("canvas");return Object.assign(h,{width:u,height:d}),h.getContext("2d").drawImage(t,0,0,e,n,0,0,u,d),h.toDataURL("image/jpeg").replace(/^data:image\/(png|jpeg);base64,/,"")}function xt(t){return[...document.querySelectorAll(`${t}`)].map(e=>e.style.backgroundImage.replace(/url\("|"\)/g,""))}function Tt(t){return Promise.all(t.map(async(e,n)=>(t[n]=await Z(e),t[n])))}async function Mt(t,e,n){const s=t.getBoundingClientRect(),r=s.left+window.scrollX,o=s.top+window.scrollY,i=r+e,a=o+n,f=new MouseEvent("mousedown",{clientX:r,clientY:o,bubbles:!0});t.dispatchEvent(f),await new Promise(g=>setTimeout(g,1e3));const u=5,d=(i-r)/u,h=(a-o)/u;for(let g=1;g<=u;g++){const p=r+d*g,m=o+h*g,A=new MouseEvent("mousemove",{clientX:p,clientY:m,bubbles:!0});t.dispatchEvent(A),await new Promise(v=>setTimeout(v,150))}await w.sleep(1e3);const E=new MouseEvent("mouseup",{clientX:i,clientY:a,bubbles:!0});t.dispatchEvent(E),await new Promise(g=>setTimeout(g,2e3))}async function qt(t,e,n){try{const r=await(await fetch(t,{method:"POST",headers:n,body:JSON.stringify(e)})).json();if(r.error&&r.error.includes("Daily limit exhausted.")){chrome.runtime.sendMessage({action:"Daily limit exhausted!"}),stop=!0;return}if(r.errorCode==="ERROR_ZERO_BALANCE"){chrome.runtime.sendMessage({action:"Insufficient Balance!"}),stop=!0;return}if(r.error&&r.error.includes("Wallet limit exhausted.")){chrome.runtime.sendMessage({action:"Wallet limit exhausted."}),stop=!0;return}return r}catch(s){throw console.error("Error fetching coordinates:",s),s}}async function Rt(t){return new Promise(e=>{chrome.runtime.sendMessage({type:"GET_IMAGE_BASE64",payload:{url:t}},n=>{n?.success?e(n.data):e(null)})})}const w={version:lt,$:y,$$:z,isMulti:K,isGrid:J,isBbox:Q,isBboxDD:dt,isWidget:ft,sleep:S,randTimer:ht,isSolved:gt,countdownNotif:ut,getBase64FromUrl:Z,refreshIframes:wt,getEn:vt,skip:bt,getBrowser:Et,shuffle:yt,fireMouseEvents:D,getCanvas:Ct,handleCanvasDD:St,getApi:It,clickMatchingElement:At,sliceOG:kt,updateExamples:Tt,getExamples:xt,solveGeetestCaptcha:Mt,sendCoordinatesRequest:qt,geeFetchImage:mt,fetchBase64Image:Rt};async function Pt(t,e,n){if(!t()||t().enabled===!1||t().options[n].active===!1)return!1;function s(a){return a.replace(/^https?:\/\/(www\.)?/,"")}const r=e(),o=s(r);return!t().blacklist.some(a=>{const f=s(a);return o===f})}const Ft={matches:["<all_urls>"],allFrames:!0,match_about_blank:!1,async main(){let t;try{t=window.top.document.location.href}catch{t=window.location.href}const[e]=X(t),[n,s]=X(await chrome.storage.local.get("settings"));s(n().settings),await Pt(n,e,"Lemin")&&(async()=>{let i=!1;n().APIKEY;const a=()=>!navigator.onLine||i||n().APIKEY===void 0||n().APIKEY===""||n().PLANTYPE===null;let f=!0;for(;!a();)await w.sleep(2e3),await(async()=>{try{const d=document.querySelector(".checkmark");d&&f&&(d.click(),await w.sleep(3e3),await $t())}catch(d){console.log("Error in solving captcha: ",d)}finally{f=!1}})()})()}},Lt=()=>{const t=document.querySelector(".captcha > div > div"),e=document.querySelectorAll(".captcha > :nth-child(3) div");let n=[];console.log("Source Image",t);for(let s=0;s<e.length;s+=2)n.push(e[s]);return{sourceImageContainer:t,dragImages:n}},$t=async()=>{const{sourceImageContainer:t,dragImages:e}=Lt();if(console.log(t,"sourceImagecontainer"),console.log(e,"dragImages"),!t||!e.length){await w.sleep(2e3);return}const n={coordinates:{0:{x:10,y:-310},1:{x:30,y:-430}}};for(const[s,{x:r,y:o}]of Object.entries(n.coordinates)){const i=e[s];if(!i){console.error(`Drag image container for piece ${s} not found.`);continue}console.log(`Moving piece ${s} to (${r}, ${o})`),t.getBoundingClientRect();const a=i.getBoundingClientRect();(a.left+a.right)/2,(a.top+a.bottom)/2,await w.solveGeetestCaptcha(i,r,o)}solving=!1},tt=globalThis.browser?.runtime?.id?globalThis.browser:globalThis.chrome;function P(t,...e){}const Dt={debug:(...t)=>P(console.debug,...t),log:(...t)=>P(console.log,...t),warn:(...t)=>P(console.warn,...t),error:(...t)=>P(console.error,...t)};class B extends Event{constructor(e,n){super(B.EVENT_NAME,{}),this.newUrl=e,this.oldUrl=n}static EVENT_NAME=O("wxt:locationchange")}function O(t){return`${tt?.runtime?.id}:leminCaptcha:${t}`}function Yt(t){let e,n;return{run(){e==null&&(n=new URL(location.href),e=t.setInterval(()=>{let s=new URL(location.href);s.href!==n.href&&(window.dispatchEvent(new B(s,n)),n=s)},1e3))}}}class F{constructor(e,n){this.contentScriptName=e,this.options=n,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}static SCRIPT_STARTED_MESSAGE_TYPE=O("wxt:content-script-started");isTopFrame=window.self===window.top;abortController;locationWatcher=Yt(this);receivedMessageIds=new Set;get signal(){return this.abortController.signal}abort(e){return this.abortController.abort(e)}get isInvalid(){return tt.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(e){return this.signal.addEventListener("abort",e),()=>this.signal.removeEventListener("abort",e)}block(){return new Promise(()=>{})}setInterval(e,n){const s=setInterval(()=>{this.isValid&&e()},n);return this.onInvalidated(()=>clearInterval(s)),s}setTimeout(e,n){const s=setTimeout(()=>{this.isValid&&e()},n);return this.onInvalidated(()=>clearTimeout(s)),s}requestAnimationFrame(e){const n=requestAnimationFrame((...s)=>{this.isValid&&e(...s)});return this.onInvalidated(()=>cancelAnimationFrame(n)),n}requestIdleCallback(e,n){const s=requestIdleCallback((...r)=>{this.signal.aborted||e(...r)},n);return this.onInvalidated(()=>cancelIdleCallback(s)),s}addEventListener(e,n,s,r){n==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),e.addEventListener?.(n.startsWith("wxt:")?O(n):n,s,{...r,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),Dt.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:F.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(e){const n=e.data?.type===F.SCRIPT_STARTED_MESSAGE_TYPE,s=e.data?.contentScriptName===this.contentScriptName,r=!this.receivedMessageIds.has(e.data?.messageId);return n&&s&&r}listenForNewerScripts(e){let n=!0;const s=r=>{if(this.verifyScriptStartedEvent(r)){this.receivedMessageIds.add(r.data.messageId);const o=n;if(n=!1,o&&e?.ignoreFirstEvent)return;this.notifyInvalidated()}};addEventListener("message",s),this.onInvalidated(()=>removeEventListener("message",s))}}function jt(){}function L(t,...e){}const Bt={debug:(...t)=>L(console.debug,...t),log:(...t)=>L(console.log,...t),warn:(...t)=>L(console.warn,...t),error:(...t)=>L(console.error,...t)};return(async()=>{try{const{main:t,...e}=Ft,n=new F("leminCaptcha",e);return await t(n)}catch(t){throw Bt.error('The content script "leminCaptcha" crashed on startup!',t),t}})()}();
lemincaptcha;
